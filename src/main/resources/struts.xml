<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
	"http://struts.apache.org/dtds/struts-2.5.dtd">
<struts>

  <include file="struts-constants.xml"/>

  <bean type="com.opensymphony.xwork2.UnknownHandler" name="tiles-convention" class="com.gruuf.web.TilesUnknownHandler"/>

  <package name="gruufDefault" extends="struts-default">

    <result-types>
      <result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult" default="true" />
      <result-type name="redirectAction" class="org.apache.struts2.result.ServletActionRedirectResult"/>
      <result-type name="jsonRedirect" class="org.apache.struts2.json.JSONActionRedirectResult"/>
      <result-type name="json" class="org.apache.struts2.json.JSONResult"/>
    </result-types>

    <interceptors>

      <interceptor name="login" class="com.gruuf.web.interceptors.LoginInterceptor"/>
      <interceptor name="user" class="com.gruuf.web.interceptors.UserInterceptor"/>
      <interceptor name="auth" class="com.gruuf.web.interceptors.AuthInterceptor"/>
      <interceptor name="secure" class="com.gruuf.web.interceptors.SecureInterceptor"/>
      <interceptor name="restriction" class="com.gruuf.web.interceptors.BikeRestrictionInterceptor"/>
      <interceptor name="json" class="org.apache.struts2.json.JSONInterceptor"/>
      <interceptor name="reCaptcha" class="com.gruuf.struts2.gae.recaptcha.ReCaptchaInterceptor"/>

      <interceptor-stack name="gruufDefaultDev">
        <interceptor-ref name="exception">
          <param name="logEnabled">true</param>
          <param name="logCategory">com.gruuf</param>
          <param name="logLevel">error</param>
        </interceptor-ref>
        <interceptor-ref name="secure"/>
        <interceptor-ref name="login"/>
        <interceptor-ref name="auth"/>
        <interceptor-ref name="user"/>
        <interceptor-ref name="restriction"/>
        <interceptor-ref name="alias"/>
        <interceptor-ref name="servletConfig"/>
        <interceptor-ref name="i18n"/>
        <interceptor-ref name="prepare"/>
        <interceptor-ref name="params"/>
        <interceptor-ref name="conversionError"/>
        <interceptor-ref name="validation">
          <param name="excludeMethods">input,back,cancel,browse</param>
        </interceptor-ref>
        <interceptor-ref name="workflow">
          <param name="excludeMethods">input,back,cancel,browse</param>
        </interceptor-ref>
      </interceptor-stack>

      <interceptor-stack name="gruufDefaultUploadDev">
        <interceptor-ref name="exception"/>
        <interceptor-ref name="secure"/>
        <interceptor-ref name="login"/>
        <interceptor-ref name="auth"/>
        <interceptor-ref name="user"/>
        <interceptor-ref name="restriction"/>
        <interceptor-ref name="alias"/>
        <interceptor-ref name="servletConfig"/>
        <interceptor-ref name="i18n"/>
        <interceptor-ref name="fileUpload">
          <param name="maximumSize">2097152</param>
        </interceptor-ref>
        <interceptor-ref name="prepare"/>
        <interceptor-ref name="params"/>
        <interceptor-ref name="conversionError"/>
        <interceptor-ref name="validation">
          <param name="excludeMethods">input,back,cancel,browse</param>
        </interceptor-ref>
        <interceptor-ref name="workflow">
          <param name="excludeMethods">input,back,cancel,browse</param>
        </interceptor-ref>
      </interceptor-stack>

      <interceptor-stack name="defaultWithMessages">
        <interceptor-ref name="gruufDefaultDev"/>
        <interceptor-ref name="store">
          <param name="operationMode">AUTOMATIC</param>
        </interceptor-ref>
      </interceptor-stack>

      <interceptor-stack name="defaultUploadWithMessages">
        <interceptor-ref name="gruufDefaultUploadDev"/>
        <interceptor-ref name="store">
          <param name="operationMode">AUTOMATIC</param>
        </interceptor-ref>
      </interceptor-stack>

      <interceptor-stack name="reCaptchaStack">
        <interceptor-ref name="gruufDefaultDev"/>
        <interceptor-ref name="reCaptcha"/>
      </interceptor-stack>
    </interceptors>

    <default-interceptor-ref name="gruufDefaultDev"/>

    <default-action-ref name="index"/>

    <default-class-ref class="com.gruuf.web.actions.BaseAction"/>

    <global-results>
      <result name="https-redirect" type="redirect">
        <param name="location">https://gruuf.com/</param>
      </result>
      <result name="login" type="redirectAction">
        <param name="actionName">login</param>
        <param name="namespace">/</param>
      </result>
      <result name="garage" type="redirectAction">
        <param name="actionName">garage</param>
        <param name="namespace">/</param>
      </result>
      <result name="error">error</result>
    </global-results>

    <global-exception-mappings>
      <exception-mapping exception="java.lang.Exception" result="error" />
    </global-exception-mappings>

  </package>

  <unknown-handler-stack>
    <unknown-handler-ref name="tiles-convention"/>
  </unknown-handler-stack>

</struts>
